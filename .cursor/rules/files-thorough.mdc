---
description: 
globs: 
alwaysApply: false
---
---
description: 
globs: 
alwaysApply: false
---
# Keystone 4 Thorough File Structure
```
├── index.js                 # Main package entry point
├── package.json            # Package configuration and dependencies
├── lib/                    # Core library files
│   ├── core/                           # Core functionality
│   │   ├── init.js                     # Initialization
│   │   ├── initDatabaseConfig.js       # Database configuration
│   │   ├── initExpressApp.js          # Express app setup
│   │   ├── initExpressSession.js      # Session handling
│   │   ├── initNav.js                 # Navigation setup
│   │   ├── openDatabaseConnection.js  # Database connection
│   │   ├── closeDatabaseConnection.js # Database disconnection
│   │   ├── createItems.js             # Item creation
│   │   ├── createKeystoneHash.js      # Hash generation
│   │   ├── createRouter.js            # Router creation
│   │   ├── getOrphanedLists.js       # List management
│   │   ├── importer.js                # Module importing
│   │   ├── list.js                    # List core functionality
│   │   ├── options.js                 # Options management
│   │   ├── populateRelated.js         # Relationship population
│   │   ├── redirect.js                # URL redirection
│   │   ├── start.js                   # Application startup
│   │   └── wrapHTMLError.js           # Error handling
│   │
│   ├── list/                          # List functionality
│   │   ├── add.js                     # Adding fields to lists
│   │   ├── addFiltersToQuery.js       # Query filtering
│   │   ├── addSearchToQuery.js        # Search functionality
│   │   ├── apiForGet.js               # GET API handling
│   │   ├── automap.js                 # Automatic mapping
│   │   ├── buildSearchTextIndex.js    # Search index building
│   │   ├── declaresTextIndex.js       # Text index declaration
│   │   ├── ensureTextIndex.js         # Text index management
│   │   ├── expandColumns.js           # Column expansion
│   │   ├── expandPaths.js             # Path expansion
│   │   ├── expandSort.js              # Sort expansion
│   │   ├── field.js                   # Field handling
│   │   ├── getAdminURL.js             # Admin URL generation
│   │   ├── getCSVData.js              # CSV data export
│   │   ├── getData.js                 # Data retrieval
│   │   ├── getDocumentName.js         # Document naming
│   │   ├── getOptions.js              # Options retrieval
│   │   ├── getPages.js                # Pagination
│   │   ├── getSearchFilters.js        # Search filter handling
│   │   ├── getUniqueValue.js          # Unique value handling
│   │   ├── isReserved.js              # Reserved word checking
│   │   ├── map.js                     # Data mapping
│   │   ├── paginate.js                # Pagination handling
│   │   ├── processFilters.js          # Filter processing
│   │   ├── register.js                # List registration
│   │   ├── relationship.js            # Relationship handling
│   │   ├── selectColumns.js           # Column selection
│   │   ├── set.js                     # Value setting
│   │   ├── underscoreMethod.js        # Underscore methods
│   │   └── updateItem.js              # Item updates
│   │
│   ├── schemaPlugins/         # Mongoose schema plugins
│   ├── security/              # Authentication and authorization
│   ├── storage/                       # Storage functionality
│   │   ├── adapters/                  # Storage adapters
│   │   │   └── fs/                    # Filesystem adapter
│   │   ├── index.js                   # Storage main module
│   │   └── README.md                  # Storage documentation
│   │
│   ├── middleware/                    # Express middleware
│   │   ├── api.js                     # API middleware
│   │   ├── cors.js                    # CORS handling
│   │   └── language.js                # Language handling
│   │
│   ├── content/                       # Content management
│   ├── list.js                       # List class definition
│   ├── view.js                        # View rendering
│   ├── updateHandler.js               # Update processing
│   ├── session.js                     # Session management
│   ├── email.js                       # Email functionality
│   ├── updates.js                     # Database updates
│   ├── uploads.js                     # File uploads
│   ├── path.js                        # Path utilities
│   ├── safeRequire.js                # Safe module requiring
│   ├── schemaPlugins.js              # Schema plugin management
│   └── fieldTypes.js                 # Field type definitions
├── server/                 # Server initialization and middleware
│   ├── createApp.js          # Express application creation
│   ├── initLetsEncrypt.js    # SSL certificate initialization
│   ├── initSslRedirect.js    # HTTPS redirect setup
│   ├── initTrustProxy.js     # Proxy trust configuration
│   ├── initViewEngine.js     # View engine setup
│   ├── initViewLocals.js     # View local variables setup
│   ├── startHTTPServer.js    # HTTP server initialization
│   ├── startSecureServer.js  # HTTPS server setup
│   ├── startSocketServer.js  # WebSocket server setup
│   ├── bindBodyParser.js     # Request body parsing
│   ├── bindErrorHandlers.js  # Error handling middleware
│   ├── bindIPRestrictions.js # IP-based access control
│   ├── bindLessMiddleware.js # LESS CSS processing
│   ├── bindRedirectsHandler.js # URL redirection handling
│   ├── bindSassMiddleware.js # SASS CSS processing
│   ├── bindSessionMiddleware.js # Session handling
│   ├── bindStaticMiddleware.js # Static file serving
│   └── bindStylusMiddleware.js # Stylus CSS processing
└── fields/                 # Field type system
    ├── README.md                         # Field system documentation
    ├── types/                           # Field type definitions
    │   ├── Type.js                      # Base type class
    │   ├── Field.js                     # Field base class
    │   ├── azurefile/                   # Azure storage field type
    │   │   ├── AzureFileType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── boolean/                     # Boolean field type
    │   │   ├── BooleanType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── cloudinaryimage/             # Single Cloudinary image field
    │   │   ├── CloudinaryImageType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── cloudinaryimages/            # Multiple Cloudinary images field
    │   │   ├── CloudinaryImagesType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── code/                        # Code editor field
    │   │   ├── CodeType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── color/                       # Color picker field
    │   │   ├── ColorType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── date/                        # Date field
    │   │   ├── DateType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── datearray/                   # Array of dates field
    │   │   ├── DateArrayType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── datetime/                    # Date and time field
    │   │   ├── DateTimeType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── email/                       # Email field
    │   │   ├── EmailType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── embedly/                     # Embedly embed field
    │   │   ├── EmbedlyType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── file/                        # File upload field
    │   │   ├── FileType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── geopoint/                    # Geographic point field
    │   │   ├── GeoPointType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── html/                        # HTML content field
    │   │   ├── HtmlType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── key/                         # Key/ID field
    │   │   ├── KeyType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── localfile/                   # Local file storage field
    │   │   ├── LocalFileType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── localfiles/                  # Multiple local files field
    │   │   ├── LocalFilesType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── location/                    # Location field
    │   │   ├── LocationType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── markdown/                    # Markdown content field
    │   │   ├── MarkdownType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── money/                       # Currency field
    │   │   ├── MoneyType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── name/                        # Name field (first, last)
    │   │   ├── NameType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── number/                      # Number field
    │   │   ├── NumberType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── numberarray/                 # Array of numbers field
    │   │   ├── NumberArrayType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── password/                    # Password field
    │   │   ├── PasswordType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── relationship/                # Relationship field
    │   │   ├── RelationshipType.js
    │   │   ├── RelationshipField.js
    │   │   ├── RelationshipColumn.js
    │   │   ├── RelationshipFilter.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── s3file/                      # Amazon S3 file field
    │   │   ├── S3FileType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── select/                      # Select/dropdown field
    │   │   ├── SelectType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── text/                        # Text field
    │   │   ├── TextType.js
    │   │   ├── TextField.js
    │   │   ├── TextColumn.js
    │   │   ├── TextFilter.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── textarea/                    # Text area field
    │   │   ├── TextareaType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   ├── textarray/                   # Array of text field
    │   │   ├── TextArrayType.js
    │   │   ├── Readme.md
    │   │   └── test/
    │   └── url/                         # URL field
    │       ├── UrlType.js
    │       ├── Readme.md
    │       └── test/
    ├── utils/                           # Field utilities
    │   ├── addPresenceToQuery.js        # Query presence helper
    │   ├── bindFunctions.js            # Function binding utility
    │   ├── definePrototypeGetters.js   # Prototype getter definitions
    │   ├── evalDependsOn.js            # Dependency evaluation
    │   └── test/                       # Utility tests
    ├── mixins/                          # Field mixins
    │   └── ArrayField.js               # Array field functionality mixin
    │
    ├── components/                      # React components for fields
    │   ├── columns/                     # Table column components
    │   ├── test/                        # Component tests
    │   ├── Checkbox.js                  # Checkbox input component
    │   ├── CollapsedFieldLabel.js      # Collapsed field label
    │   ├── DateInput.js                # Date input component
    │   ├── FileChangeMessage.js        # File change notification
    │   ├── HiddenFileInput.js          # Hidden file input
    │   ├── ImageThumbnail.js           # Image thumbnail display
    │   ├── ItemsTableCell.js           # Table cell component
    │   ├── ItemsTableValue.js          # Table value component
    │   └── NestedFormField.js          # Nested form field component
    │
    └── explorer/                        # Field exploration utilities






```




